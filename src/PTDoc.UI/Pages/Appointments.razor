@page "/appointments"
@attribute [Authorize]

<PageTitle>Appointments - PTDoc</PageTitle>

<div class="appointments-page">
    <AppointmentsPageHeader Title="Appointments" 
                           Subtitle="Daily schedule management" />
    
    <div class="appointments-content">
        <AppointmentsLeftColumn SelectedView="@selectedView"
                               OnViewChanged="HandleViewChanged"
                               SelectedDate="@selectedDate"
                               OnPrevDay="HandlePrevDay"
                               OnNextDay="HandleNextDay"
                               OnToday="HandleToday"
                               TotalCount="12"
                               InProgressCount="1"
                               CheckedInCount="1"
                               MissingIntakeCount="2" />
        
        <AppointmentsRightColumn ViewLabel="@GetViewLabel()"
                                SelectedDate="@selectedDate" />
    </div>
</div>

@code {
    private string selectedView = "Today";
    private DateTime selectedDate = DateTime.Today;

    private void HandleViewChanged(string view)
    {
        selectedView = view;
    }

    private void HandlePrevDay()
    {
        selectedDate = selectedDate.AddDays(-1);
    }

    private void HandleNextDay()
    {
        selectedDate = selectedDate.AddDays(1);
    }

    private void HandleToday()
    {
        selectedDate = DateTime.Today;
    }

    private string GetViewLabel()
    {
        return selectedView == "Today" ? "Today's Appointments" : "This Week's Appointments";
    }
}
