@* Incomplete Intake Forms Card - Shows patient intakes awaiting completion *@

<div class="card incomplete-intakes-card">
    <div class="card-header">
        <div class="card-header-left">
            <svg class="section-icon" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path d="M9.33333 2H4C3.64638 2 3.30724 2.14048 3.05719 2.39052C2.80714 2.64057 2.66667 2.97971 2.66667 3.33333V12.6667C2.66667 13.0203 2.80714 13.3594 3.05719 13.6095C3.30724 13.8595 3.64638 14 4 14H12C12.3536 14 12.6928 13.8595 12.9428 13.6095C13.1929 13.3594 13.3333 13.0203 13.3333 12.6667V6L9.33333 2Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M9.33333 2V6H13.3333" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <h3 class="card-title">Incomplete Intake Forms</h3>
            <span class="count-badge">@(_intakes?.Count ?? 0)</span>
        </div>
        <button type="button" class="view-all-link" aria-label="View all intakes">
            View All
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path d="M4.5 9L7.5 6L4.5 3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </button>
    </div>
    
    <div class="card-content">
        @if (_intakes == null || !_intakes.Any())
        {
            <div class="empty-state">
                <p class="empty-state-text">No incomplete intakes</p>
            </div>
        }
        else
        {
            <div class="intakes-list">
                @foreach (var intake in _intakes)
                {
                    <div class="intake-item intake-priority-@intake.Priority.ToLower()">
                        <div class="intake-header">
                            <div class="intake-header-left">
                                <svg class="intake-icon" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                    <path d="M8 14.6667C11.6819 14.6667 14.6667 11.6819 14.6667 8C14.6667 4.3181 11.6819 1.33333 8 1.33333C4.3181 1.33333 1.33333 4.3181 1.33333 8C1.33333 11.6819 4.3181 14.6667 8 14.6667Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M8 5.33333V8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M8 10.6667H8.00667" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                <span class="intake-name">@intake.PatientName</span>
                            </div>
                            <span class="priority-badge priority-@intake.Priority.ToLower()">@intake.Priority.ToUpper()</span>
                        </div>
                        
                        <div class="intake-id">ID: @intake.Id</div>
                        
                        <div class="intake-completion">
                            <span class="completion-label">Completion</span>
                            <span class="completion-value">@intake.CompletionPercentage%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: @intake.CompletionPercentage%"></div>
                        </div>
                        
                        <div class="intake-meta">
                            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                <path d="M6 11C8.76142 11 11 8.76142 11 6C11 3.23858 8.76142 1 6 1C3.23858 1 1 3.23858 1 6C1 8.76142 3.23858 11 6 11Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M6 3V6L8 7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span>Sent @intake.DaysSent day@(intake.DaysSent != 1 ? "s" : "") ago</span>
                            <span>@intake.RemindersSent reminder@(intake.RemindersSent != 1 ? "s" : "") sent</span>
                        </div>
                        
                        @if (!string.IsNullOrEmpty(intake.UrgentMessage))
                        {
                            <div class="intake-alert">
                                @intake.UrgentMessage
                            </div>
                        }
                        
                        <div class="intake-actions">
                            <button type="button" class="btn btn-sm btn-outline" aria-label="Resend intake to @intake.PatientName">
                                <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                    <path d="M12.8333 1.16667L6.41667 7.58333" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M12.8333 1.16667L8.75 12.8333L6.41667 7.58333L1.16667 5.25L12.8333 1.16667Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Resend
                            </button>
                            <button type="button" class="btn btn-sm btn-outline" aria-label="View intake for @intake.PatientName">
                                <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                    <path d="M8.16667 2.33333C8.49614 2.33333 8.82199 2.39814 9.12593 2.52393C9.42988 2.64971 9.70595 2.83408 9.93785 3.06598C10.1698 3.29788 10.3541 3.57395 10.4799 3.87789C10.6057 4.18184 10.6705 4.50769 10.6705 4.83716C10.6705 5.16664 10.6057 5.49249 10.4799 5.79644C10.3541 6.10038 10.1698 6.37645 9.93785 6.60835L3.5 13.0462" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M10.5 11.6667C11.4205 11.6667 12.1667 10.9205 12.1667 10C12.1667 9.07953 11.4205 8.33333 10.5 8.33333C9.57953 8.33333 8.83333 9.07953 8.83333 10C8.83333 10.9205 9.57953 11.6667 10.5 11.6667Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                View
                            </button>
                        </div>
                    </div>
                }
            </div>
            
            <div class="intakes-summary">
                <span class="summary-text">1 urgent • 1 medium • 1 low priority</span>
                <button type="button" class="view-all-link" aria-label="View all intakes">
                    View All Intakes
                    <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M4.5 9L7.5 6L4.5 3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
            </div>
        }
    </div>
</div>

@code {
    private List<IncompleteIntake>? _intakes;
    
    protected override void OnInitialized()
    {
        // Mock data - replace with actual service call
        _intakes = new List<IncompleteIntake>
        {
            new IncompleteIntake 
            { 
                Id = "PT-2024-009",
                PatientName = "Lisa",
                Priority = "high",
                CompletionPercentage = 0,
                DaysSent = 4,
                RemindersSent = 3,
                UrgentMessage = "Urgent: No progress after 4 days"
            },
            new IncompleteIntake 
            { 
                Id = "PT-2024-005",
                PatientName = "Emily R",
                Priority = "medium",
                CompletionPercentage = 33,
                DaysSent = 2,
                RemindersSent = 2,
                UrgentMessage = null
            },
            new IncompleteIntake 
            { 
                Id = "PT-2024-007",
                PatientName = "David Kim",
                Priority = "low",
                CompletionPercentage = 16,
                DaysSent = 1,
                RemindersSent = 1,
                UrgentMessage = null
            }
        };
    }
    
    private class IncompleteIntake
    {
        public string Id { get; set; } = string.Empty;
        public string PatientName { get; set; } = string.Empty;
        public string Priority { get; set; } = string.Empty;
        public int CompletionPercentage { get; set; }
        public int DaysSent { get; set; }
        public int RemindersSent { get; set; }
        public string? UrgentMessage { get; set; }
    }
}
